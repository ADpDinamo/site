{% extends "base.html" %}

{% load static i18n %}
{% load crispy_forms_tags %}
{% load cookie_consent_tags %}


{% block intro %}
<div class="page-header" style="background-image: url({% static 'images/landing.png' %})">
  <div class="container">

    <div class="row" id="testing">
      <div class="d-none d-sm-none d-md-block col-md-3 align-self-center">
        <img src="{% static 'images/logoADPD.png' %}" alt="Thumbnail Image" class="rounded-circle img-fluid">
      </div>
      <div class="col-md-9">
        {% if request.user.is_authenticated %}
        <h1 class="title">Bine ai venit în familia Dinamo!</h1>
        {% else %}
        <h1 class="title">Totul pentru Dinamo!</h1>
        {% endif %}
        <h4>De multă vreme noi, suporterii, avem nemulțumiri în legătură cu deciziile luate de către conducerea clubului. Lucrurile nu par să se îmbunătățească odată cu trecerea anilor, ci chiar să devină mai rele. În acest context, un grup de
          suporteri a venit cu ideea de a da o voce relevantă tuturor celor ce iubesc Dinamo.<br>
          Alătură-te ADPD și fă parte cu adevărat din istoria lui Dinamo!</h4>
        {% if request.user.is_authenticated %}

        <form method="post" action="{% url 'account_logout' %}">
          {% csrf_token %}
          {% if redirect_field_value %}
          <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
          {% endif %}
          <button class="btn btn-primary-inv btn-round" type="submit">{% trans 'Sign Out' %}</button>
        </form>

        {% else %}
        <button class="btn btn-primary-inv btn-round" data-toggle="modal" data-target="#loginModal" href="{% url 'account_login' %}">Autentificare</button>
        {% endif %}
      </div>

    </div>

  </div>
</div>
{% endblock %}
{% block main_content %}
<div class="pricing-5" id="pricing-5">
  <div class="container">
    <div class="row">
      <div class="col-md-6 ml-auto mr-auto text-center">
        <h2 class="title">Înscrie-te acum!</h2>
        <h5 class="description">Lista beneficiilor oferite de către asociație membrilor săi va suferi modificări substanțiale pe măsură ce Asociația va avea contracte de colaborare cu diferiți parteneri.</h5>
        <!--<div class="section-space"></div>-->
      </div>
    </div>
    <div class="row">
      <div class="col-md-4 ml-auto">
        <div class="card card-pricing">
          <div class="card-body ">
            <h6 class="card-category">Seniori</h6>
            <h1 class="card-title">
              <small>RON</small>150
              <small>/an</small>
            </h1>
            <ul>
              <li>
                posibilitatea de a cumpăra cu reduceri tricouri, echipamente sportive, efecte</li>
              <li>
                participarea la activitățile sportive și sociale, recreative, culturale sau științifice, pe care Asociația le organizează</li>
            </ul>
            <a href="#pablo" class="btn btn-primary btn-round">
              Get Started
            </a>
          </div>
        </div>
      </div>
      <div class="col-md-4 mr-auto">
        <div class="card card-pricing card-raised bg-primary">
          <div class="card-body">
            <h6 class="card-category">Adulți</h6>
            <h1 class="card-title">
              <small>RON</small>400
              <small>/an</small>
            </h1>
            <ul>
              <li>
                posibilitatea de a cumpăra cu reduceri tricouri, echipamente sportive, efecte</li>
              <li>
                participarea la activitățile sportive și sociale, recreative, culturale sau științifice, pe care Asociația le organizează</li>
            </ul>
            <a href="#pablo" class="btn btn-white btn-round">
              Get Started
            </a>
          </div>
        </div>
      </div>
      <div class="col-md-4 ml-auto">
        <div class="card card-pricing">
          <div class="card-body ">
            <h6 class="card-category">Copii</h6>
            <h1 class="card-title">
              <small>RON</small>100
              <small>/an</small>
            </h1>
            <ul>
              <li>
                posibilitatea de a cumpăra cu reduceri tricouri, echipamente sportive, efecte</li>
              <li>
                participarea la activitățile sportive și sociale, recreative, culturale sau științifice, pe care Asociația le organizează</li>
            </ul>
            <a href="#pablo" class="btn btn-primary btn-round">
              Get Started
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block login_modal %}
{% if request.user.is_authenticated %}

{% else %}
<div class="modal fade" id="loginModal" tabindex="-1" role="">
  <div class="modal-dialog modal-login" role="document">
    <div class="modal-content">
      <div class="card card-signup card-plain">
        <div class="modal-header">
          <div class="card-header card-header-primary text-center">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
              <i class="material-icons">clear</i>
            </button>
            <h4 class="card-title">Autentificare</h4>
            <div class="social-line">

            </div>
          </div>
        </div>
        <div class="modal-body">

          <form id="logare" class="login" method="POST" action="{% url 'account_login' %}">
            {% csrf_token %}
            <div class="card-body">
              <div class="form-group bmd-form-group">
                <div class="input-group">
                  <div class="input-group-prepend">
                    <div class="input-group-text"><i class="material-icons">face</i></div>
                  </div>
                  <input type="text" name="login" class="form-control" id="id_login" autocomplete="username" placeholder="Utilizator..." />
                </div>
              </div>
              <div class="form-group bmd-form-group">
                <p>{{form.login.errors}}</p>
                <div class="input-group">
                  <div class="input-group-prepend">
                    <div class="input-group-text"><i class="material-icons">lock_outline</i></div>
                  </div>
                  <input type="password" name="password" class="form-control" id="id_password" autocomplete="current-password" placeholder="Parolă..." />
                </div>
              </div>
              {% if redirect_field_value %}
              <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
              {% endif %}
              <button id="confirma" class="btn btn-primary btn-round">{% trans "Confirmă" %}</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endif %}

{% endblock %}

{% block javascript %}
<script type="text/javascript">
  $(document).on('submit', '#loginModal', function(e) {
    $('#loginModal').on('hidden.bs.modal', function(e) {
      $(this).find('form')[0].reset();
      $(this).removeData();
      $('.social-line')[0].innerHTML = "";
      $('i')[1].innerText = 'face';
      login.attr("placeholder", "Utilizator...")
      $('i')[2].innerText = 'lock_outline';
      passw.attr("placeholder", "Parolă...")
    });
    e.preventDefault();

    var login = $('#id_login');
    var passw = $('#id_password');

    login.keyup(function() {
      $('i')[1].innerText = 'face';
    });
    passw.keyup(function() {
      $('i')[2].innerText = 'lock_outline';
    });

    if (login.val() === '' && passw.val() === '') {

      $('i')[1].innerText = 'clear';
      login.attr("placeholder", "Acest câmp este obligatoriu");

      $('i')[2].innerText = 'clear';
      passw.attr("placeholder", "Acest câmp este obligatoriu");

    } else if (login.val() === '') {

      $('i')[1].innerText = 'clear';
      login.attr("placeholder", "Acest câmp este obligatoriu");

      $('i')[2].innerText = 'lock_outline';
      passw.attr("placeholder", "Parolă")

    } else if (passw.val() === '') {

      $('i')[1].innerText = 'face';
      login.attr("placeholder", "Utilizator");

      $('i')[2].innerText = 'clear';
      passw.attr("placeholder", "Acest câmp este obligatoriu")

    } else {
      $.ajax({
        type: 'POST',
        url: '{% url "account_login" %}',
        data: {
          login: login.val(),
          password: passw.val(),
          csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
        },
        success: function() {
          window.location = '{% url "account_login" %}'
        },
        error: function() {
          $('.social-line')[0].innerHTML = "<h4>Utilizator sau parolă incorecte</h4>";
        }
      });
    };
  });
</script>
{% endblock %}
